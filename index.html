<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Mayfa!</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        } 
        
        body.no-scroll { 
            overflow: hidden; 
        } 
        
        body { 
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); 
            min-height: 100vh; 
            transition: background 0.5s ease; 
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        } 
        
        /* MODERN LOGIN STYLES */
        .login-container {
            width: 100%;
            max-width: 480px;
            perspective: 1000px;
        }
        
        .login-box {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.25);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25), 
                        0 8px 20px rgba(0, 0, 0, 0.15),
                        inset 0 0 12px rgba(255, 255, 255, 0.15);
            border-radius: 24px;
            padding: 50px 40px;
            text-align: center;
            transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275), 
                        opacity 0.5s ease, 
                        box-shadow 0.3s ease;
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
        }
        
        .login-box::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, transparent 70%);
            transform: rotate(30deg);
            z-index: -1;
            pointer-events: none;
        }
        
        .login-box.hidden { 
            transform: rotateY(90deg) scale(0.8); 
            opacity: 0; 
            display: none; 
        } 
        
        .login-header {
            margin-bottom: 40px;
            position: relative;
        }
        
        .login-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            border: 2px solid rgba(255,255,255,0.25);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            animation: float 4s ease-in-out infinite;
            position: relative;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .login-icon i {
            font-size: 48px;
            color: #ffd166;
            text-shadow: 0 0 15px rgba(255, 209, 102, 0.5);
            position: relative;
            z-index: 2;
        }
        
        /* Lilin dan Api */
        .candle {
            position: absolute;
            top: -10px;
            width: 8px;
            height: 15px;
            background: linear-gradient(to bottom, #fff, #ffd166);
            border-radius: 4px 4px 0 0;
            z-index: 1;
        }
        
        .flame {
            position: absolute;
            top: -22px;
            width: 12px;
            height: 20px;
            background: linear-gradient(to bottom, #ffd166, #ff6b6b);
            border-radius: 50% 50% 20% 20%;
            animation: flicker 1.5s infinite alternate;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.6);
        }
        
        @keyframes flicker {
            0%, 100% {
                transform: scale(1);
                opacity: 0.9;
            }
            50% {
                transform: scale(1.1);
                opacity: 1;
            }
        }
        
        .login-box h1 { 
            color: #fff; 
            font-size: 32px; 
            font-weight: 600;
            letter-spacing: 0.5px;
            text-shadow: 0 2px 8px rgba(0,0,0,0.2);
        } 
        
        .input-group { 
            position: relative; 
            margin-bottom: 30px; 
        } 
        
        .input-group .icon { 
            position: absolute; 
            left: 20px; 
            top: 50%; 
            transform: translateY(-50%); 
            color: rgba(255, 255, 255, 0.8); 
            transition: all 0.3s ease; 
            font-size: 18px;
        } 
        
        .input-group input { 
            width: 100%; 
            padding: 18px 20px 18px 60px; 
            background: rgba(255, 255, 255, 0.1); 
            border: 2px solid rgba(255, 255, 255, 0.2); 
            color: #fff; 
            font-size: 16px; 
            transition: all 0.3s; 
            border-radius: 15px;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        } 
        
        .input-group input:focus { 
            outline: none; 
            border-color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
        } 
        
        .input-group input::placeholder { 
            color: rgba(255, 255, 255, 0.65); 
        } 
        
        .input-group:focus-within .icon { 
            color: #ffffff; 
            transform: translateY(-50%) scale(1.1);
        } 
        
        #togglePassword { 
            position: absolute; 
            right: 20px; 
            top: 50%; 
            transform: translateY(-50%); 
            cursor: pointer; 
            color: rgba(255, 255, 255, 0.8); 
            font-size: 18px;
            transition: all 0.3s ease;
        } 
        
        #togglePassword:hover {
            color: #ffffff;
            transform: translateY(-50%) scale(1.1);
        }
        
        .login-options { 
            text-align: right; 
            margin-top: -10px; 
            margin-bottom: 30px; 
        } 
        
        .admin-link { 
            color: rgba(255, 255, 255, 0.8); 
            text-decoration: none; 
            font-size: 14px; 
            font-weight: 400; 
            display: inline-flex; 
            align-items: center; 
            gap: 6px; 
            transition: all 0.3s ease; 
        } 
        
        .admin-link:hover { 
            color: #fff; 
        } 
        
        .admin-link i { 
            font-size: 16px; 
            transition: transform 0.4s ease; 
        } 
        
        .admin-link:hover i { 
            transform: rotate(60deg); 
        } 
        
        .login-btn { 
            width: 100%; 
            padding: 18px; 
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(245,245,245,0.95) 100%);
            border: none; 
            border-radius: 15px; 
            color: #2575fc; 
            font-size: 18px; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            letter-spacing: 0.5px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
            position: relative;
            overflow: hidden;
        } 
        
        .login-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }
        
        .login-btn:hover::before {
            left: 100%;
        }
        
        .login-btn:hover { 
            transform: translateY(-5px); 
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
            background: linear-gradient(135deg, rgba(255,255,255,1) 0%, rgba(245,245,245,1) 100%);
        } 
        
        .login-btn:active {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }
        
        .login-footer {
            margin-top: 30px;
            color: rgba(255,255,255,0.7);
            font-size: 14px;
            text-align: center;
        }
        
        .glow-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 24px;
            box-shadow: inset 0 0 50px rgba(255,255,255,0.1),
                        0 0 80px rgba(106, 17, 203, 0.3);
            pointer-events: none;
            z-index: -1;
            animation: glow-pulse 4s ease-in-out infinite;
        }
        
        @keyframes glow-pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        /* Birthday Page Styles */
        .birthday-page-container { 
            display: none; 
            align-items: flex-start; 
            padding-top: 8vh; 
            padding-bottom: 8vh; 
            width: 100%;
            max-width: 1000px;
        } 
        
        .birthday-content { 
            width: 100%; 
            text-align: center; 
            z-index: 10; 
        } 
        
        .main-title { 
            font-family: 'Pacifico', cursive; 
            font-size: clamp(3rem, 10vw, 6rem); 
            line-height: 1.2; 
            color: #fff; 
            text-shadow: 0 0 15px rgba(255,255,255,0.5), 0 0 25px rgba(255,255,255,0.5); 
            animation: fadeInDown 1s ease-out forwards; 
        } 
        
        .main-title span { 
            background: linear-gradient(45deg, #ffd166, #ff6b6b); 
            -webkit-background-clip: text; 
            background-clip: text; 
            color: transparent; 
        } 
        
        .card-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 20px; 
            margin-top: 40px; 
        } 
        
        .message-card { 
            background: rgba(255, 255, 255, 0.15); 
            backdrop-filter: blur(12px); 
            -webkit-backdrop-filter: blur(12px); 
            border-radius: 20px; 
            border: 1px solid rgba(255, 255, 255, 0.2); 
            padding: 30px; 
            color: white; 
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1); 
            opacity: 0; 
            animation: revealCard 0.8s ease-out forwards; 
        } 
        
        .message-card:nth-child(1) { 
            animation-delay: 0.5s; 
        } 
        
        .message-card:nth-child(2) { 
            animation-delay: 0.8s; 
        } 
        
        .message-card:nth-child(3) { 
            animation-delay: 1.1s; 
        } 
        
        .card-icon { 
            font-size: 2.5rem; 
            margin-bottom: 15px; 
            color: #ffd166; 
        } 
        
        .card-title { 
            font-size: 1.5rem; 
            font-weight: 600; 
            margin-bottom: 10px; 
        } 
        
        .card-text { 
            font-size: 1rem; 
            line-height: 1.6; 
            font-weight: 300; 
        } 
        
        #ageDisplay { 
            font-size: 1.2rem; 
            font-weight: 400; 
        } 
        
        .gift-btn-modern { 
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%); 
            border: none; 
            border-radius: 50px; 
            padding: 15px 40px; 
            font-size: 1.2rem; 
            color: white; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4); 
            margin-top: 20px; 
        } 
        
        .gift-btn-modern:hover { 
            transform: translateY(-5px) scale(1.05); 
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.6); 
        } 
        
        @keyframes fadeInDown { 
            from { 
                opacity: 0; 
                transform: translateY(-50px); 
            } 
            to { 
                opacity: 1; 
                transform: translateY(0); 
            } 
        } 
        
        @keyframes revealCard { 
            from { 
                opacity: 0; 
                transform: translateY(40px) scale(0.95); 
            } 
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            } 
        } 
        
        .particle { 
            position: fixed; 
            border-radius: 50%; 
            z-index: 3000; 
            opacity: 0; 
            pointer-events: none; 
        } 
        
        .drifting-particle { 
            position: fixed; 
            top: -20px; 
            border-radius: 50%; 
            opacity: 0.8; 
            pointer-events: none; 
            z-index: 1; 
        } 
        
        /* Modern Balloon Styles */
        .balloon {
            position: absolute;
            bottom: -100px;
            z-index: 1;
            animation: floatBalloon linear forwards;
            transform: translateZ(0);
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));
        }
        
        .balloon-body {
            position: relative;
            border-radius: 50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8), var(--color) 70%);
        }
        
        .balloon-highlight {
            position: absolute;
            top: 20%;
            left: 20%;
            width: 15%;
            height: 15%;
            background: rgba(255,255,255,0.6);
            border-radius: 50%;
        }
        
        .balloon-string {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            height: 30px;
            width: 2px;
            background: rgba(255,255,255,0.8);
        }
        
        .balloon-knot {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 8px;
            height: 8px;
            background: rgba(255,255,255,0.8);
            border-radius: 50%;
        }
        
        @keyframes floatBalloon {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 0.8;
            }
            25% {
                transform: translateY(-30vh) translateX(5vw) rotate(5deg);
            }
            50% {
                transform: translateY(-60vh) translateX(-5vw) rotate(-5deg);
            }
            75% {
                transform: translateY(-90vh) translateX(3vw) rotate(3deg);
            }
            100% {
                transform: translateY(-130vh) translateX(-3vw) rotate(-3deg);
                opacity: 0;
            }
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--color);
            border-radius: 50%;
            animation: fall linear forwards;
            z-index: 0;
        }
        
        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .feedback-modal, 
        .gift-modal { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0, 0, 0, 0.6); 
            backdrop-filter: blur(4px); 
            z-index: 2000; 
            justify-content: center; 
            align-items: center; 
            padding: 15px; 
        } 
        
        .feedback-content { 
            background: white; 
            border-radius: 15px; 
            padding: 30px 40px; 
            text-align: center; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); 
            width: 90%; 
            max-width: 350px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
        } 
        
        .feedback-content .icon-container { 
            width: 60px; 
            height: 60px; 
            margin-bottom: 20px; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
        } 
        
        .feedback-content .icon { 
            font-size: 60px; 
        } 
        
        .feedback-content .icon.success { 
            color: #28a745; 
        } 
        
        .feedback-content .icon.failure { 
            color: #dc3545; 
        } 
        
        .feedback-content h2 { 
            font-size: 24px; 
            color: #333; 
            margin-bottom: 10px; 
            font-weight: 600; 
        } 
        
        @keyframes popIn { 
            0% { 
                transform: scale(0.7); 
                opacity: 0; 
            } 
            80% { 
                transform: scale(1.1); 
                opacity: 1; 
            } 
            100% { 
                transform: scale(1); 
            } 
        } 
        
        .feedback-content .icon { 
            animation: popIn 0.5s ease-out forwards; 
        } 
        
        @keyframes spin { 
            0% { 
                transform: rotate(0deg); 
            } 
            100% { 
                transform: rotate(360deg); 
            } 
        } 
        
        .loader { 
            border: 6px solid #f3f3f3; 
            border-top: 6px solid #2575fc; 
            border-radius: 50%; 
            width: 50px; 
            height: 50px; 
            animation: spin 1s linear infinite; 
        } 
        
        .hidden { 
            display: none; 
        } 
        
        .gift-box { 
            position: relative; 
            width: 250px; 
            height: 250px; 
            cursor: pointer; 
            animation: wobble-gift 2s ease-in-out infinite; 
        } 
        
        @keyframes wobble-gift { 
            0%, 100% { 
                transform: rotate(-3deg) scale(1); 
            } 
            50% { 
                transform: rotate(3deg) scale(1.05); 
            } 
        } 
        
        .gift-card { 
            display: none; 
            background: white; 
            border-radius: 15px; 
            padding: 30px; 
            text-align: center; 
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3); 
            width: 100%; 
            max-width: 320px; 
            z-index: 1001; 
            animation: fadeInCard 0.5s ease-out; 
        } 
        
        @keyframes fadeInCard { 
            from { 
                opacity: 0; 
                transform: scale(0.8); 
            } 
            to { 
                opacity: 1; 
                transform: scale(1); 
            } 
        }
        
        .firebase-config {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            max-width: 500px;
            margin: 20px auto;
            font-size: 14px;
        }
        
        @media (max-width: 480px) {
            .login-box { padding: 25px; }
            .login-box h1 { font-size: 28px; }
            .gift-card { padding: 20px; }
            
            .login-icon {
                width: 80px;
                height: 80px;
            }
            
            .login-icon i {
                font-size: 36px;
            }
            
            .candle {
                top: -8px;
                width: 6px;
                height: 12px;
            }
            
            .flame {
                top: -18px;
                width: 10px;
                height: 16px;
            }
        }
    </style>
</head>
<body>
    <audio id="background-music" loop><source src="mayfa.mp3"></audio>
    <div class="login-container" id="loginContainer">
        <div class="login-box" id="loginBox">
            <div class="glow-effect"></div>
            <div class="login-header">
                <div class="login-icon">
                    <i class="fas fa-birthday-cake"></i>
                    <div class="candle"></div>
                    <div class="flame"></div>
                </div>
                <h1> Login Dulu Ya✨</h1>
            </div>
            <div class="input-group">
                <i class="fas fa-user icon"></i>
                <input type="text" id="username" placeholder="Username">
            </div>
            <div class="input-group">
                <i class="fas fa-lock icon"></i>
                <input type="password" id="password" placeholder="Password">
                <i class="fas fa-eye" id="togglePassword"></i>
            </div>
            <div class="login-options">
                <a href="admin.html" class="admin-link" title="Pengaturan Admin"><i class="fas fa-cog"></i> Admin</a>
            </div>
            <button class="login-btn" onclick="login()">Login</button>
            <div class="login-footer">
                Masukkan kredensial untuk melihat kejutan spesial
            </div>
        </div>
    </div>
    <div class="birthday-page-container" id="birthdayPage">
        <div class="birthday-content">
            <h1 class="main-title">Happy Birthday, <span id="birthdayName">Mayfa!</span></h1>
            <div class="card-grid">
                <div class="message-card">
                    <i class="fas fa-calendar-check card-icon"></i>
                    <h2 class="card-title">Spesial Untukmu</h2>
                    <p class="card-text" id="ageDisplay"></p>
                </div>
                <div class="message-card">
                    <i class="fas fa-star card-icon"></i>
                    <h2 class="card-title">Harapan Terbaik</h2>
                    <p class="card-text">Semoga di hari spesial ini, kamu dikelilingi oleh kebahagiaan, cinta, dan semua hal indah yang kamu impikan.</p>
                </div>
                <div class="message-card">
                    <i class="fas fa-heart card-icon"></i>
                    <h2 class="card-title">Tetap Kuat</h2>
                    <p class="card-text">"Sudah berapa lama kamu bertahan?" Apapun yang terjadi, kamu hebat. Teruslah melangkah!</p>
                </div>
            </div>
            <div class="message-card" style="margin-top: 20px; animation-delay: 1.4s;">
                <h2 class="card-title">Ada Sesuatu Untukmu...</h2>
                <button class="gift-btn-modern" onclick="openGift()">
                    <i class="fas fa-gift"></i> Buka Hadiah Spesial
                </button>
            </div>
        </div>
    </div>
    <div class="gift-modal" id="giftModal">
        <div class="gift-box" onclick="openCard()">
            <img src="https://i.ibb.co/3h2bGJd/gift-box.png" alt="Gift Box" style="width: 100%; height: 100%; object-fit: contain;">
        </div>
        <div class="gift-card" id="giftCard">
            <h2 style="font-weight: 600;">Hadiah Spesial untuk <span id="giftCardName"></span>!</h2>
            <p>Scan QR code di bawah ini</p>
            <img id="qrCodeImg" alt="QR Code Hadiah" style="width: 180px; height: 180px; margin: 15px auto; border-radius: 10px; border: 10px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.2);">
            <p>Semoga harimu menyenangkan!</p>
        </div>
    </div>
    <div class="feedback-modal" id="successModal">
        <div class="feedback-content">
            <div class="icon-container">
                <div class="loader"></div>
                <i class="fas fa-check-circle icon success hidden"></i>
            </div>
            <h2>Login Berhasil!</h2>
            <p>Mempersiapkan kejutan...</p>
        </div>
    </div>
    <div class="feedback-modal" id="failureModal">
        <div class="feedback-content">
            <div class="icon-container">
                <div class="loader"></div>
                <i class="fas fa-times-circle icon failure hidden"></i>
            </div>
            <h2 id="failure-title">Login Gagal!</h2>
            <p id="failure-message">Coba cek lagi...</p>
        </div>
    </div>
    
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCWl2CJqIr-u8lSHu8s4tgZ25UQIK2ivt0",
            authDomain: "mayfa-fa284.firebaseapp.com",
            databaseURL: "https://mayfa-fa284-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "mayfa-fa284",
            storageBucket: "mayfa-fa284.appspot.com",
            messagingSenderId: "523290705179",
            appId: "1:523290705179:web:b06ae4d8e6b08cf07b27be"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Global variables
        let GUEST_USER = "user";
        let GUEST_PASS = "user";
        let BIRTHDAY_NAME = "Mayfa";
        let BIRTH_DATE = "2005-09-28";
        let QR_IMAGE_URL = "";

        // Load settings from Firebase
        database.ref('settings').on('value', (snapshot) => {
            const settings = snapshot.val();
            if (settings) {
                GUEST_USER = settings.guestUser || "user";
                GUEST_PASS = settings.guestPass || "user";
                BIRTHDAY_NAME = settings.birthdayName || "Mayfa";
                BIRTH_DATE = settings.birthDate || "2005-09-28";
                QR_IMAGE_URL = settings.qrImageUrl || "";
                
                // Update UI if birthday page is visible
                if (document.getElementById('birthdayName')) {
                    document.getElementById('birthdayName').textContent = BIRTHDAY_NAME + "!";
                    calculateAndDisplayAge(BIRTH_DATE);
                }
            }
        });

        const loginContainer = document.getElementById("loginContainer");
        const loginBox = document.getElementById("loginBox");
        const birthdayPage = document.getElementById("birthdayPage");
        const giftModal = document.getElementById("giftModal");
        const giftBox = document.querySelector(".gift-box");
        const giftCard = document.getElementById("giftCard");
        const backgroundMusic = document.getElementById("background-music");
        const togglePassword = document.getElementById("togglePassword");
        const passwordInput = document.getElementById("password");
        const successModal = document.getElementById("successModal");
        const successLoader = successModal.querySelector(".loader");
        const successIcon = successModal.querySelector(".icon.success");
        const failureModal = document.getElementById("failureModal");
        const failureLoader = failureModal.querySelector(".loader");
        const failureIcon = failureModal.querySelector(".icon.failure");
        const failureTitle = failureModal.querySelector("#failure-title");
        const failureMessage = failureModal.querySelector("#failure-message");
        
        let fireworksInterval, driftingConfettiInterval;
        
        // Modern login animation
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                loginBox.style.transform = 'scale(1)';
                loginBox.style.opacity = '1';
            }, 100);
            
            // Floating particles for login background
            setInterval(() => {
                createDriftingParticle();
            }, 300);
        });
        
        togglePassword.addEventListener("click", function() {
            this.classList.add("icon-toggle-animation");
            const type = passwordInput.getAttribute("type") === "password" ? "text" : "password";
            passwordInput.setAttribute("type", type);
            this.classList.toggle("fa-eye");
            this.classList.toggle("fa-eye-slash");
            
            this.addEventListener("animationend", () => {
                this.classList.remove("icon-toggle-animation");
            }, { once: true });
        });
        
        function calculateAndDisplayAge(birthDate) {
            const birthDateObj = new Date(birthDate);
            const today = new Date();
            let age = today.getFullYear() - birthDateObj.getFullYear();
            const monthDiff = today.getMonth() - birthDateObj.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDateObj.getDate())) {
                age--;
            }
            
            document.getElementById("ageDisplay").innerText = `Hari ini usiamu genap ${age} tahun. Selamat!`;
        }
        
        function login() {
            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;
            
            if (username === GUEST_USER && password === GUEST_PASS) {
                // Login success animation
                loginBox.style.transform = 'translateY(-20px) rotateY(20deg)';
                loginBox.style.boxShadow = '0 25px 50px rgba(0, 0, 0, 0.3)';
                
                successLoader.classList.remove("hidden");
                successIcon.classList.add("hidden");
                successModal.style.display = "flex";
                
                setTimeout(() => {
                    loginBox.style.transform = 'translateY(40px) rotateY(-90deg) scale(0.8)';
                    loginBox.style.opacity = '0';
                    
                    setTimeout(() => {
                        successLoader.classList.add("hidden");
                        successIcon.classList.remove("hidden");
                        
                        setTimeout(() => {
                            successModal.style.display = "none";
                            loginBox.classList.add("hidden");
                            
                            setTimeout(() => {
                                loginContainer.style.display = "none";
                                birthdayPage.style.display = "flex";
                                document.body.classList.remove("no-scroll");
                                
                                try {
                                    backgroundMusic.play().catch(e => {
                                        console.log("Autoplay gagal: ", e);
                                    });
                                } catch (e) {
                                    console.log("Autoplay error: ", e);
                                }
                                
                                document.getElementById("birthdayName").textContent = BIRTHDAY_NAME + "!";
                                calculateAndDisplayAge(BIRTH_DATE);
                                startDriftingConfetti();
                                createBalloons(15);
                            }, 500);
                        }, 1000);
                    }, 1500);
                }, 300);
            } else {
                // Login failure animation
                loginBox.animate([
                    { transform: 'translateX(0px)', easing: 'ease-in' },
                    { transform: 'translateX(-15px)', easing: 'ease-out' },
                    { transform: 'translateX(15px)', easing: 'ease-in' },
                    { transform: 'translateX(0px)', easing: 'ease-out' }
                ], {
                    duration: 600,
                    iterations: 1
                });
                
                failureLoader.classList.remove("hidden");
                failureIcon.classList.add("hidden");
                failureTitle.textContent = "Mengecek...";
                failureMessage.textContent = "Memverifikasi username & password.";
                failureModal.style.display = "flex";
                
                setTimeout(() => {
                    failureLoader.classList.add("hidden");
                    failureIcon.classList.remove("hidden");
                    failureTitle.textContent = "Login Gagal!";
                    failureMessage.textContent = "Silakan coba lagi.";
                    
                    setTimeout(() => {
                        failureModal.style.display = "none";
                    }, 1500);
                }, 1500);
            }
        }
        
        function createBalloons(count) {
            const colors = [
                '#FF6B6B', '#FF8E53', '#4ECDC4', '#6A11CB', 
                '#2575FC', '#FFD166', '#EF476F', '#118AB2'
            ];
            
            for (let i = 0; i < count; i++) {
                const balloon = document.createElement('div');
                balloon.classList.add('balloon');
                
                // Random size between 60px and 100px
                const size = Math.random() * 40 + 60;
                balloon.style.width = `${size}px`;
                balloon.style.height = `${size * 1.1}px`;
                balloon.style.left = `${Math.random() * 100}%`;
                
                // Random color
                const color = colors[Math.floor(Math.random() * colors.length)];
                balloon.style.setProperty('--color', color);
                
                // Random animation duration
                const duration = Math.random() * 15 + 20;
                balloon.style.animationDuration = `${duration}s`;
                balloon.style.animationDelay = `${Math.random() * 2}s`;
                
                // Create balloon body
                const balloonBody = document.createElement('div');
                balloonBody.classList.add('balloon-body');
                
                // Create highlight
                const highlight = document.createElement('div');
                highlight.classList.add('balloon-highlight');
                
                // Create string
                const string = document.createElement('div');
                string.classList.add('balloon-string');
                
                // Create knot
                const knot = document.createElement('div');
                knot.classList.add('balloon-knot');
                
                // Assemble balloon
                balloonBody.appendChild(highlight);
                balloon.appendChild(balloonBody);
                balloon.appendChild(string);
                balloon.appendChild(knot);
                
                document.body.appendChild(balloon);
                
                // Create confetti when balloon pops
                setTimeout(() => {
                    createConfetti(balloon.offsetLeft + size/2, balloon.offsetTop + size/2, color);
                    balloon.remove();
                }, duration * 1000);
            }
            
            // Create floating confetti
            createConfettiFall();
        }
        
        // Create confetti explosion
        function createConfetti(x, y, color) {
            for (let i = 0; i < 25; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.setProperty('--color', color);
                confetti.style.left = `${x}px`;
                confetti.style.top = `${y}px`;
                
                // Random size
                const size = Math.random() * 8 + 4;
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                
                // Random animation
                const duration = Math.random() * 2 + 1;
                confetti.style.animationDuration = `${duration}s`;
                
                // Random direction
                confetti.style.setProperty('--x', (Math.random() - 0.5) * 200);
                
                document.body.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, duration * 1000);
            }
        }
        
        // Create falling confetti
        function createConfettiFall() {
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti');
                    confetti.style.setProperty('--color', [
                        '#FF6B6B', '#FF8E53', '#4ECDC4', '#6A11CB', 
                        '#2575FC', '#FFD166', '#EF476F', '#118AB2'
                    ][Math.floor(Math.random() * 8)]);
                    confetti.style.left = `${Math.random() * 100}%`;
                    
                    // Random size
                    const size = Math.random() * 10 + 5;
                    confetti.style.width = `${size}px`;
                    confetti.style.height = `${size}px`;
                    
                    // Random animation
                    const duration = Math.random() * 5 + 5;
                    confetti.style.animationDuration = `${duration}s`;
                    confetti.style.opacity = Math.random() * 0.5 + 0.5;
                    
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, duration * 1000);
                }, i * 200);
            }
        }
        
        function createDriftingParticle() {
            const particle = document.createElement("div");
            particle.className = "drifting-particle";
            document.body.appendChild(particle);
            
            const size = Math.random() * 5 + 3;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.background = ["#ff6b6b", "#ffd166", "#4ecdc4", "#ffffff"][Math.floor(Math.random() * 4)];
            particle.style.left = Math.random() * 100 + "vw";
            
            const duration = Math.random() * 5000 + 5000;
            const xOffset = 200 * (Math.random() - 0.5);
            const rotation = 720 * Math.random();
            
            particle.animate([
                { transform: "translate(0, 0) rotate(0deg)", opacity: 1 },
                { transform: `translate(${xOffset}px, 105vh) rotate(${rotation}deg)`, opacity: 0 }
            ], {
                duration: duration,
                easing: "linear"
            }).onfinish = () => particle.remove();
        }
        
        function startDriftingConfetti() {
            if (driftingConfettiInterval) clearInterval(driftingConfettiInterval);
            driftingConfettiInterval = setInterval(createDriftingParticle, 200);
        }
        
        function createParticle(x, y) {
            const particle = document.createElement("div");
            particle.classList.add("particle");
            document.body.appendChild(particle);
            
            const size = Math.floor(Math.random() * 7 + 5);
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.background = ["#ff6b6b", "#ff8e53", "#6a11cb", "#2575fc", "#4ecdc4", "#ffd166", "#fff"][Math.floor(Math.random() * 7)];
            
            const xOffset = 400 * (Math.random() - 0.5);
            const yOffset = 400 * (Math.random() - 0.5);
            const duration = Math.random() * 800 + 700;
            
            particle.style.left = `${x}px`;
            particle.style.top = `${y}px`;
            
            particle.animate([
                { transform: "translate(0, 0)", opacity: 1 },
                { transform: `translate(${xOffset}px, ${yOffset}px)`, opacity: 0 }
            ], {
                duration: duration,
                easing: "cubic-bezier(0.1, 0.7, 1.0, 0.1)"
            }).onfinish = () => particle.remove();
        }
        
        function createFireworkExplosion() {
            const x = window.innerWidth * 0.6 * (0.2 + Math.random());
            const y = window.innerHeight * 0.6 * (0.2 + Math.random());
            
            for (let i = 0; i < 30; i++) {
                createParticle(x, y);
            }
        }
        
        function startFireworks() {
            if (fireworksInterval) clearInterval(fireworksInterval);
            fireworksInterval = setInterval(createFireworkExplosion, 400);
        }
        
        function stopFireworks() {
            clearInterval(fireworksInterval);
        }
        
        function openGift() {
            giftModal.style.display = "flex";
        }
        
        function openCard() {
            giftBox.style.display = "none";
            giftCard.style.display = "block";
            document.getElementById("giftCardName").textContent = BIRTHDAY_NAME;
            
            const qrImg = document.getElementById("qrCodeImg");
            
            // Menggunakan QR code dari URL yang disimpan di Firebase
            if (QR_IMAGE_URL) {
                qrImg.src = QR_IMAGE_URL;
                qrImg.style.border = "10px solid white";
                qrImg.style.boxShadow = "0 5px 15px rgba(0,0,0,0.2)";
            } else {
                // Fallback ke QR code generator jika tidak ada gambar yang diunggah
                let qrData = `Selamat Ulang Tahun ${BIRTHDAY_NAME}!`;
                const encodedData = encodeURIComponent(qrData);
                qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodedData}`;
            }
            
            startFireworks();
        }
        
        function closeGiftModal() {
            giftModal.style.display = "none";
            giftCard.style.display = "none";
            giftBox.style.display = "block";
            stopFireworks();
        }
        
        giftModal.addEventListener("click", e => {
            if (e.target === giftModal) {
                closeGiftModal();
            }
        });
        
        // Initialize
        document.addEventListener("DOMContentLoaded", () => {
            document.body.classList.add("no-scroll");
            birthdayPage.style.display = "none";
            giftModal.style.display = "none";
            
            // Initial login box state for animation
            loginBox.style.transform = 'scale(0.9) rotateY(30deg)';
            loginBox.style.opacity = '0';
            
            document.body.addEventListener("click", () => {
                backgroundMusic.play();
            }, { once: true });
        });
    </script>
</body>
</html>